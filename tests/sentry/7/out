[36mcommit 48d81f61f905d0c92f840d3806b05f19965daddf
[0m[36mAuthor: k-fish <6111995+k-fish@users.noreply.github.com>
[0m[36mDate:   Mon Jun 22 12:28:37 2020 -0700
[0m[36m
[0m[36m    fix(discover): Fixed incorrect tags from showing in autocomplete (#19459)
[0m[36m    
[0m[36m    Fixed incorrect tags from showing in autocomplete
[0m[36m    
[0m[36m    `count()` for example was showing up in the autocomplete if you had visited discover before visiting the performance landing page. The search bar would then incorrectly show it as a recommendation
[0m[36m    
[0m[36m    This was caused by assigning into a reused object, I turned it into a proper field and switched field keys to an `Enum` so that it could be used with record to make sure the field tags and values correctly mapped to real field keys.
[0m[36m    
[0m[36m    * Remove export from enum and switch to generating FIELD_TAGS again
[0m[36m    * Replace 'as const' and assert with direct typing
[0m[36m
[0m[36mdiff --git a/src/sentry/static/sentry/app/utils/discover/fields.tsx b/src/sentry/static/sentry/app/utils/discover/fields.tsx
[0m[36mindex 7c0ea52762..69ae69024d 100644
[0m[33m--- a/src/sentry/static/sentry/app/utils/discover/fields.tsx
[0m[33m+++ b/src/sentry/static/sentry/app/utils/discover/fields.tsx
[0m[1;34m@@ -261,83 +261,153 @@ export type Aggregation = {
[0m[33m261[0m [0m  multiPlotType: PlotType;[0m                                   [0m[33m261[0m [0m  multiPlotType: PlotType;[0m
[33m262[0m [0m};[0m                                                           [0m[33m262[0m [0m};[0m
[33m   [0m                                                              [0m[33m263[0m [32m[0m
[33m   [0m                                                              [0m[33m264[0m [32menum FieldKey {[0m
[33m   [0m                                                              [0m[33m265[0m [32m  CULPRIT = 'culprit',[0m
[33m   [0m                                                              [0m[33m266[0m [32m  DEVICE_ARCH = 'device.arch',[0m
[33m   [0m                                                              [0m[33m267[0m [32m  DEVICE_BATTERY_LEVEL = 'device.battery_level',[0m
[33m   [0m                                                              [0m[33m268[0m [32m  DEVICE_BRAND = 'device.brand',[0m
[33m   [0m                                                              [0m[33m269[0m [32m  DEVICE_CHARGING = 'device.charging',[0m
[33m   [0m                                                              [0m[33m270[0m [32m  DEVICE_LOCALE = 'device.locale',[0m
[33m   [0m                                                              [0m[33m271[0m [32m  DEVICE_NAME = 'device.name',[0m
[33m   [0m                                                              [0m[33m272[0m [32m  DEVICE_ONLINE = 'device.online',[0m
[33m   [0m                                                              [0m[33m273[0m [32m  DEVICE_ORIENTATION = 'device.orientation',[0m
[33m   [0m                                                              [0m[33m274[0m [32m  DEVICE_SIMULATOR = 'device.simulator',[0m
[33m   [0m                                                              [0m[33m275[0m [32m  DEVICE_UUID = 'device.uuid',[0m
[33m   [0m                                                              [0m[33m276[0m [32m  DIST = 'dist',[0m
[33m   [0m                                                              [0m[33m277[0m [32m  ENVIRONMENT = 'environment',[0m
[33m   [0m                                                              [0m[33m278[0m [32m  ERROR_HANDLED = 'error.handled',[0m
[33m   [0m                                                              [0m[33m279[0m [32m  ERROR_MECHANISM = 'error.mechanism',[0m
[33m   [0m                                                              [0m[33m280[0m [32m  ERROR_TYPE = 'error.type',[0m
[33m   [0m                                                              [0m[33m281[0m [32m  ERROR_VALUE = 'error.value',[0m
[33m   [0m                                                              [0m[33m282[0m [32m  EVENT_TYPE = 'event.type',[0m
[33m   [0m                                                              [0m[33m283[0m [32m  GEO_CITY = 'geo.city',[0m
[33m   [0m                                                              [0m[33m284[0m [32m  GEO_COUNTRY_CODE = 'geo.country_code',[0m
[33m   [0m                                                              [0m[33m285[0m [32m  GEO_REGION = 'geo.region',[0m
[33m   [0m                                                              [0m[33m286[0m [32m  HTTP_METHOD = 'http.method',[0m
[33m   [0m                                                              [0m[33m287[0m [32m  HTTP_URL = 'http.url',[0m
[33m   [0m                                                              [0m[33m288[0m [32m  ID = 'id',[0m
[33m   [0m                                                              [0m[33m289[0m [32m  ISSUE = 'issue',[0m
[33m   [0m                                                              [0m[33m290[0m [32m  LOCATION = 'location',[0m
[33m   [0m                                                              [0m[33m291[0m [32m  MESSAGE = 'message',[0m
[33m   [0m                                                              [0m[33m292[0m [32m  OS_BUILD = 'os.build',[0m
[33m   [0m                                                              [0m[33m293[0m [32m  OS_KERNEL_VERSION = 'os.kernel_version',[0m
[33m   [0m                                                              [0m[33m294[0m [32m  PLATFORM_NAME = 'platform.name',[0m
[33m   [0m                                                              [0m[33m295[0m [32m  PROJECT = 'project',[0m
[33m   [0m                                                              [0m[33m296[0m [32m  RELEASE = 'release',[0m
[33m   [0m                                                              [0m[33m297[0m [32m  SDK_NAME = 'sdk.name',[0m
[33m   [0m                                                              [0m[33m298[0m [32m  SDK_VERSION = 'sdk.version',[0m
[33m   [0m                                                              [0m[33m299[0m [32m  STACK_ABS_PATH = 'stack.abs_path',[0m
[33m   [0m                                                              [0m[33m300[0m [32m  STACK_COLNO = 'stack.colno',[0m
[33m   [0m                                                              [0m[33m301[0m [32m  STACK_FILENAME = 'stack.filename',[0m
[33m   [0m                                                              [0m[33m302[0m [32m  STACK_FUNCTION = 'stack.function',[0m
[33m   [0m                                                              [0m[33m303[0m [32m  STACK_IN_APP = 'stack.in_app',[0m
[33m   [0m                                                              [0m[33m304[0m [32m  STACK_LINENO = 'stack.lineno',[0m
[33m   [0m                                                              [0m[33m305[0m [32m  STACK_MODULE = 'stack.module',[0m
[33m   [0m                                                              [0m[33m306[0m [32m  STACK_PACKAGE = 'stack.package',[0m
[33m   [0m                                                              [0m[33m307[0m [32m  STACK_STACK_LEVEL = 'stack.stack_level',[0m
[33m   [0m                                                              [0m[33m308[0m [32m  TIME = 'time',[0m
[33m   [0m                                                              [0m[33m309[0m [32m  TIMESTAMP = 'timestamp',[0m
[33m   [0m                                                              [0m[33m310[0m [32m  TITLE = 'title',[0m
[33m   [0m                                                              [0m[33m311[0m [32m  TRACE = 'trace',[0m
[33m   [0m                                                              [0m[33m312[0m [32m  TRACE_PARENT_SPAN = 'trace.parent_span',[0m
[33m   [0m                                                              [0m[33m313[0m [32m  TRACE_SPAN = 'trace.span',[0m
[33m   [0m                                                              [0m[33m314[0m [32m  TRANSACTION = 'transaction',[0m
[33m   [0m                                                              [0m[33m315[0m [32m  TRANSACTION_DURATION = 'transaction.duration',[0m
[33m   [0m                                                              [0m[33m316[0m [32m  TRANSACTION_OP = 'transaction.op',[0m
[33m   [0m                                                              [0m[33m317[0m [32m  TRANSACTION_STATUS = 'transaction.status',[0m
[33m   [0m                                                              [0m[33m318[0m [32m  USER = 'user',[0m
[33m   [0m                                                              [0m[33m319[0m [32m  USER_EMAIL = 'user.email',[0m
[33m   [0m                                                              [0m[33m320[0m [32m  USER_ID = 'user.id',[0m
[33m   [0m                                                              [0m[33m321[0m [32m  USER_IP = 'user.ip',[0m
[33m   [0m                                                              [0m[33m322[0m [32m  USER_USERNAME = 'user.username',[0m
[33m   [0m                                                              [0m[33m323[0m [32m}[0m
[33m263[0m [0m[0m                                                             [0m[33m324[0m [0m[0m
[33m264[0m [0m/**[0m                                                          [0m[33m325[0m [0m/**[0m
[33m265[0m [0m * Refer to src/sentry/snuba/events.py, search for Columns[0m   [0m[33m326[0m [0m * Refer to src/sentry/snuba/events.py, search for Columns[0m
[33m266[0m [0m */[0m                                                          [0m[33m327[0m [0m */[0m
[33m267[0m [22m[7m[31mexport const FIELDS = {[0m                                      [0m[33m328[0m [22m[7m[32mexport const FIELDS: Readonly<Record<FieldKey, ColumnType>> [0m
[33m   [0m                                                              [0m[33m   [0m [32m[7m[22m= {[0m
[33m268[0m [22m[7m[31m  id: 'string',[0m                                              [0m[33m329[0m [22m[7m[32m  [FieldKey.ID]: 'string',[0m
[33m269[0m [0m  // issue.id and project.id are omitted on purpose.[0m         [0m[33m330[0m [0m  // issue.id and project.id are omitted on purpose.[0m
[33m270[0m [0m  // Customers should use `issue` and `project` instead.[0m     [0m[33m331[0m [0m  // Customers should use `issue` and `project` instead.[0m
[33m271[0m [22m[7m[31m  timestamp: 'date',[0m                                         [0m[33m332[0m [22m[7m[32m  [FieldKey.TIMESTAMP]: 'date',[0m
[33m272[0m [22m[7m[31m  time: 'date',[0m                                              [0m[33m333[0m [22m[7m[32m  [FieldKey.TIME]: 'date',[0m
[33m273[0m [0m[0m                                                             [0m[33m334[0m [0m[0m
[33m274[0m [22m[7m[31m  culprit: 'string',[0m                                         [0m[33m335[0m [22m[7m[32m  [FieldKey.CULPRIT]: 'string',[0m
[33m275[0m [22m[7m[31m  location: 'string',[0m                                        [0m[33m336[0m [22m[7m[32m  [FieldKey.LOCATION]: 'string',[0m
[33m276[0m [22m[7m[31m  message: 'string',[0m                                         [0m[33m337[0m [22m[7m[32m  [FieldKey.MESSAGE]: 'string',[0m
[33m277[0m [22m[7m[31m  'platform.name': 'string',[0m                                 [0m[33m338[0m [22m[7m[32m  [FieldKey.PLATFORM_NAME]: 'string',[0m
[33m278[0m [22m[7m[31m  environment: 'string',[0m                                     [0m[33m339[0m [22m[7m[32m  [FieldKey.ENVIRONMENT]: 'string',[0m
[33m279[0m [22m[7m[31m  release: 'string',[0m                                         [0m[33m340[0m [22m[7m[32m  [FieldKey.RELEASE]: 'string',[0m
[33m280[0m [22m[7m[31m  dist: 'string',[0m                                            [0m[33m341[0m [22m[7m[32m  [FieldKey.DIST]: 'string',[0m
[33m281[0m [22m[7m[31m  title: 'string',[0m                                           [0m[33m342[0m [22m[7m[32m  [FieldKey.TITLE]: 'string',[0m
[33m282[0m [22m[7m[31m  'event.type': 'string',[0m                                    [0m[33m343[0m [22m[7m[32m  [FieldKey.EVENT_TYPE]: 'string',[0m
[33m283[0m [0m  // tags.key and tags.value are omitted on purpose as well.[0m [0m[33m344[0m [0m  // tags.key and tags.value are omitted on purpose as well.[0m
[33m284[0m [0m[0m                                                             [0m[33m345[0m [0m[0m
[33m285[0m [22m[7m[31m  transaction: 'string',[0m                                     [0m[33m346[0m [22m[7m[32m  [FieldKey.TRANSACTION]: 'string',[0m
[33m286[0m [22m[7m[31m  user: 'string',[0m                                            [0m[33m347[0m [22m[7m[32m  [FieldKey.USER]: 'string',[0m
[33m287[0m [22m[7m[31m  'user.id': 'string',[0m                                       [0m[33m348[0m [22m[7m[32m  [FieldKey.USER_ID]: 'string',[0m
[33m288[0m [22m[7m[31m  'user.email': 'string',[0m                                    [0m[33m349[0m [22m[7m[32m  [FieldKey.USER_EMAIL]: 'string',[0m
[33m289[0m [22m[7m[31m  'user.username': 'string',[0m                                 [0m[33m350[0m [22m[7m[32m  [FieldKey.USER_USERNAME]: 'string',[0m
[33m290[0m [22m[7m[31m  'user.ip': 'string',[0m                                       [0m[33m351[0m [22m[7m[32m  [FieldKey.USER_IP]: 'string',[0m
[33m291[0m [22m[7m[31m  'sdk.name': 'string',[0m                                      [0m[33m352[0m [22m[7m[32m  [FieldKey.SDK_NAME]: 'string',[0m
[33m292[0m [22m[7m[31m  'sdk.version': 'string',[0m                                   [0m[33m353[0m [22m[7m[32m  [FieldKey.SDK_VERSION]: 'string',[0m
[33m293[0m [22m[7m[31m  'http.method': 'string',[0m                                   [0m[33m354[0m [22m[7m[32m  [FieldKey.HTTP_METHOD]: 'string',[0m
[33m294[0m [22m[7m[31m  'http.url': 'string',[0m                                      [0m[33m355[0m [22m[7m[32m  [FieldKey.HTTP_URL]: 'string',[0m
[33m295[0m [22m[7m[31m  'os.build': 'string',[0m                                      [0m[33m356[0m [22m[7m[32m  [FieldKey.OS_BUILD]: 'string',[0m
[33m296[0m [22m[7m[31m  'os.kernel_version': 'string',[0m                             [0m[33m357[0m [22m[7m[32m  [FieldKey.OS_KERNEL_VERSION]: 'string',[0m
[33m297[0m [22m[7m[31m  'device.name': 'string',[0m                                   [0m[33m358[0m [22m[7m[32m  [FieldKey.DEVICE_NAME]: 'string',[0m
[33m298[0m [22m[7m[31m  'device.brand': 'string',[0m                                  [0m[33m359[0m [22m[7m[32m  [FieldKey.DEVICE_BRAND]: 'string',[0m
[33m299[0m [22m[7m[31m  'device.locale': 'string',[0m                                 [0m[33m360[0m [22m[7m[32m  [FieldKey.DEVICE_LOCALE]: 'string',[0m
[33m300[0m [22m[7m[31m  'device.uuid': 'string',[0m                                   [0m[33m361[0m [22m[7m[32m  [FieldKey.DEVICE_UUID]: 'string',[0m
[33m301[0m [22m[7m[31m  'device.arch': 'string',[0m                                   [0m[33m362[0m [22m[7m[32m  [FieldKey.DEVICE_ARCH]: 'string',[0m
[33m302[0m [22m[7m[31m  'device.battery_level': 'number',[0m                          [0m[33m363[0m [22m[7m[32m  [FieldKey.DEVICE_BATTERY_LEVEL]: 'number',[0m
[33m303[0m [22m[7m[31m  'device.orientation': 'string',[0m                            [0m[33m364[0m [22m[7m[32m  [FieldKey.DEVICE_ORIENTATION]: 'string',[0m
[33m304[0m [22m[7m[31m  'device.simulator': 'boolean',[0m                             [0m[33m365[0m [22m[7m[32m  [FieldKey.DEVICE_SIMULATOR]: 'boolean',[0m
[33m305[0m [22m[7m[31m  'device.online': 'boolean',[0m                                [0m[33m366[0m [22m[7m[32m  [FieldKey.DEVICE_ONLINE]: 'boolean',[0m
[33m306[0m [22m[7m[31m  'device.charging': 'boolean',[0m                              [0m[33m367[0m [22m[7m[32m  [FieldKey.DEVICE_CHARGING]: 'boolean',[0m
[33m307[0m [22m[7m[31m  'geo.country_code': 'string',[0m                              [0m[33m368[0m [22m[7m[32m  [FieldKey.GEO_COUNTRY_CODE]: 'string',[0m
[33m308[0m [22m[7m[31m  'geo.region': 'string',[0m                                    [0m[33m369[0m [22m[7m[32m  [FieldKey.GEO_REGION]: 'string',[0m
[33m309[0m [22m[7m[31m  'geo.city': 'string',[0m                                      [0m[33m370[0m [22m[7m[32m  [FieldKey.GEO_CITY]: 'string',[0m
[33m310[0m [22m[7m[31m  'error.type': 'string',[0m                                    [0m[33m371[0m [22m[7m[32m  [FieldKey.ERROR_TYPE]: 'string',[0m
[33m311[0m [22m[7m[31m  'error.value': 'string',[0m                                   [0m[33m372[0m [22m[7m[32m  [FieldKey.ERROR_VALUE]: 'string',[0m
[33m312[0m [22m[7m[31m  'error.mechanism': 'string',[0m                               [0m[33m373[0m [22m[7m[32m  [FieldKey.ERROR_MECHANISM]: 'string',[0m
[33m313[0m [22m[7m[31m  'error.handled': 'boolean',[0m                                [0m[33m374[0m [22m[7m[32m  [FieldKey.ERROR_HANDLED]: 'boolean',[0m
[33m314[0m [22m[7m[31m  'stack.abs_path': 'string',[0m                                [0m[33m375[0m [22m[7m[32m  [FieldKey.STACK_ABS_PATH]: 'string',[0m
[33m315[0m [22m[7m[31m  'stack.filename': 'string',[0m                                [0m[33m376[0m [22m[7m[32m  [FieldKey.STACK_FILENAME]: 'string',[0m
[33m316[0m [22m[7m[31m  'stack.package': 'string',[0m                                 [0m[33m377[0m [22m[7m[32m  [FieldKey.STACK_PACKAGE]: 'string',[0m
[33m317[0m [22m[7m[31m  'stack.module': 'string',[0m                                  [0m[33m378[0m [22m[7m[32m  [FieldKey.STACK_MODULE]: 'string',[0m
[33m318[0m [22m[7m[31m  'stack.function': 'string',[0m                                [0m[33m379[0m [22m[7m[32m  [FieldKey.STACK_FUNCTION]: 'string',[0m
[33m319[0m [22m[7m[31m  'stack.in_app': 'boolean',[0m                                 [0m[33m380[0m [22m[7m[32m  [FieldKey.STACK_IN_APP]: 'boolean',[0m
[33m320[0m [22m[7m[31m  'stack.colno': 'number',[0m                                   [0m[33m381[0m [22m[7m[32m  [FieldKey.STACK_COLNO]: 'number',[0m
[33m321[0m [22m[7m[31m  'stack.lineno': 'number',[0m                                  [0m[33m382[0m [22m[7m[32m  [FieldKey.STACK_LINENO]: 'number',[0m
[33m322[0m [22m[7m[31m  'stack.stack_level': 'number',[0m                             [0m[33m383[0m [22m[7m[32m  [FieldKey.STACK_STACK_LEVEL]: 'number',[0m
[33m323[0m [0m  // contexts.key and contexts.value omitted on purpose.[0m     [0m[33m384[0m [0m  // contexts.key and contexts.value omitted on purpose.[0m
[33m324[0m [0m[0m                                                             [0m[33m385[0m [0m[0m
[33m325[0m [0m  // Transaction event fields.[0m                               [0m[33m386[0m [0m  // Transaction event fields.[0m
[33m326[0m [22m[7m[31m  'transaction.duration': 'duration',[0m                        [0m[33m387[0m [22m[7m[32m  [FieldKey.TRANSACTION_DURATION]: 'duration',[0m
[33m327[0m [22m[7m[31m  'transaction.op': 'string',[0m                                [0m[33m388[0m [22m[7m[32m  [FieldKey.TRANSACTION_OP]: 'string',[0m
[33m328[0m [22m[7m[31m  'transaction.status': 'string',[0m                            [0m[33m389[0m [22m[7m[32m  [FieldKey.TRANSACTION_STATUS]: 'string',[0m
[33m329[0m [0m[0m                                                             [0m[33m390[0m [0m[0m
[33m330[0m [22m[7m[31m  trace: 'string',[0m                                           [0m[33m391[0m [22m[7m[32m  [FieldKey.TRACE]: 'string',[0m
[33m331[0m [22m[7m[31m  'trace.span': 'string',[0m                                    [0m[33m392[0m [22m[7m[32m  [FieldKey.TRACE_SPAN]: 'string',[0m
[33m332[0m [22m[7m[31m  'trace.parent_span': 'string',[0m                             [0m[33m393[0m [22m[7m[32m  [FieldKey.TRACE_PARENT_SPAN]: 'string',[0m
[33m333[0m [0m[0m                                                             [0m[33m394[0m [0m[0m
[33m334[0m [0m  // Field alises defined in src/sentry/api/event_search.py[0m  [0m[33m395[0m [0m  // Field alises defined in src/sentry/api/event_search.py[0m
[33m335[0m [22m[7m[31m  project: 'string',[0m                                         [0m[33m396[0m [22m[7m[32m  [FieldKey.PROJECT]: 'string',[0m
[33m336[0m [22m[7m[31m  issue: 'string',[0m                                           [0m[33m397[0m [22m[7m[32m  [FieldKey.ISSUE]: 'string',[0m
[33m337[0m [22m[7m[31m} as const;[0m                                                  [0m[33m398[0m [22m[7m[32m};[0m
[33m338[0m [1;31massert(FIELDS as Readonly<{[key in keyof typeof FIELDS]: Col[0m [0m[33m   [0m 
[33m   [0m [1;31mumnType}>);[0m                                                  [0m[33m   [0m 
[33m339[0m [0m[0m                                                             [0m[33m399[0m [0m[0m
[33m340[0m [22m[7m[31mexport type FieldKey = keyof typeof FIELDS | string | '';[0m    [0m[33m400[0m [22m[7m[32mexport type FieldTag = {[0m
[33m   [0m                                                              [0m[33m401[0m [32m  key: FieldKey;[0m
[33m   [0m                                                              [0m[33m402[0m [32m  name: FieldKey;[0m
[33m   [0m                                                              [0m[33m403[0m [32m};[0m
[33m   [0m                                                              [0m[33m404[0m [32m[0m
[33m   [0m                                                              [0m[33m405[0m [32mexport const FIELD_TAGS = Object.freeze([0m
[33m   [0m                                                              [0m[33m406[0m [32m  Object.fromEntries(Object.keys(FIELDS).map(item => [item, [0m
[33m   [0m                                                              [0m[33m   [0m [32m{key: item, name: item}]))[0m
[33m   [0m                                                              [0m[33m407[0m [32m);[0m
[33m   [0m                                                              [0m[33m408[0m [32m[0m
[33m   [0m                                                              [0m[33m409[0m [32m// Allows for a less strict field key definition in cases we[0m
[33m   [0m                                                              [0m[33m   [0m [32m are returning custom strings as fields[0m
[33m   [0m                                                              [0m[33m410[0m [32mexport type LooseFieldKey = FieldKey | string | '';[0m
[33m341[0m [0m[0m                                                             [0m[33m411[0m [0m[0m
[33m342[0m [0m// This list should be removed with the tranaction-events fe [0m[33m412[0m [0m// This list should be removed with the tranaction-events fe
[33m   [0m ature flag.[0m                                                  [0m[33m   [0m ature flag.[0m
[33m343[0m [0mexport const TRACING_FIELDS = [[0m                              [0m[33m413[0m [0mexport const TRACING_FIELDS = [[0m
[36mdiff --git a/src/sentry/static/sentry/app/views/events/searchBar.tsx b/src/sentry/static/sentry/app/views/events/searchBar.tsx
[0m[36mindex 2bee7646e3..10c503474e 100644
[0m[33m--- a/src/sentry/static/sentry/app/views/events/searchBar.tsx
[0m[33m+++ b/src/sentry/static/sentry/app/views/events/searchBar.tsx
[0m[1;34m@@ -12,7 +12,7 @@ import {defined} from 'app/utils';
[0m[33m 12[0m [0mimport {fetchTagValues} from 'app/actionCreators/tags';[0m      [0m[33m 12[0m [0mimport {fetchTagValues} from 'app/actionCreators/tags';[0m
[33m 13[0m [0mimport SentryTypes from 'app/sentryTypes';[0m                   [0m[33m 13[0m [0mimport SentryTypes from 'app/sentryTypes';[0m
[33m 14[0m [0mimport SmartSearchBar, {SearchType} from 'app/components/sma [0m[33m 14[0m [0mimport SmartSearchBar, {SearchType} from 'app/components/sma
[33m   [0m rtSearchBar';[0m                                                [0m[33m   [0m rtSearchBar';[0m
[33m 15[0m [22mimport {Field, FIELDS, TRACING_FIELDS} from 'app/utils/disco[0m [0m[33m 15[0m [22mimport {Field, FIELD[7m[32m_TAG[0m[22mS, TRACING_FIELDS} from 'app/utils/d[0m
[33m   [0m [22mver/fields';[0m                                                 [0m[33m   [0m [22miscover/fields';[0m
[33m 16[0m [0mimport withApi from 'app/utils/withApi';[0m                     [0m[33m 16[0m [0mimport withApi from 'app/utils/withApi';[0m
[33m 17[0m [0mimport withTags from 'app/utils/withTags';[0m                   [0m[33m 17[0m [0mimport withTags from 'app/utils/withTags';[0m
[33m 18[0m [0mimport {Client} from 'app/api';[0m                              [0m[33m 18[0m [0mimport {Client} from 'app/api';[0m
[1;34m@@ -23,10 +23,6 @@ const SEARCH_SPECIAL_CHARS_REGEXP = new RegExp(
[0m[33m 23[0m [0m  'g'[0m                                                        [0m[33m 23[0m [0m  'g'[0m
[33m 24[0m [1;31m);[0m                                                           [0m[33m   [0m 
[33m 25[0m [1;31m[0m                                                             [0m[33m   [0m 
[33m 26[0m [1;31mconst FIELD_TAGS = Object.fromEntries([0m                       [0m[33m   [0m 
[33m 27[0m [1;31m  Object.keys(FIELDS).map(item => [item, {key: item, name: i[0m [0m[33m   [0m 
[33m   [0m [1;31mtem}])[0m                                                       [0m[33m   [0m 
[33m 28[0m [0m);[0m                                                           [0m[33m 24[0m [0m);[0m
[33m 29[0m [0m[0m                                                             [0m[33m 25[0m [0m[0m
[33m 30[0m [0mtype SearchBarProps = Omit<React.ComponentProps<typeof Smart [0m[33m 26[0m [0mtype SearchBarProps = Omit<React.ComponentProps<typeof Smart
[33m   [0m SearchBar>, 'tags'> & {[0m                                      [0m[33m   [0m SearchBar>, 'tags'> & {[0m
[33m 31[0m [0m  api: Client;[0m                                               [0m[33m 27[0m [0m  api: Client;[0m
[33m 32[0m [0m  organization: Organization;[0m                                [0m[33m 28[0m [0m  organization: Organization;[0m
[1;34m@@ -101,7 +97,7 @@ class SearchBar extends React.PureComponent<SearchBarProps> {
[0m[33m101[0m [0m      : {};[0m                                                  [0m[33m 97[0m [0m      : {};[0m
[33m102[0m [0m[0m                                                             [0m[33m 98[0m [0m[0m
[33m103[0m [0m    const fieldTags = organization.features.includes('perfor [0m[33m 99[0m [0m    const fieldTags = organization.features.includes('perfor
[33m   [0m mance-view')[0m                                                 [0m[33m   [0m mance-view')[0m
[33m104[0m [22m      ? assign(FIELD_TAGS, functionTags)[0m                     [0m[33m100[0m [22m      ? [7m[32mObject.[0m[22massign([7m[32m{}, [0m[22mFIELD_TAGS, functionTags)[0m
[33m105[0m [0m      : omit(FIELD_TAGS, TRACING_FIELDS);[0m                    [0m[33m101[0m [0m      : omit(FIELD_TAGS, TRACING_FIELDS);[0m
[33m106[0m [0m[0m                                                             [0m[33m102[0m [0m[0m
[33m107[0m [0m    const combined = assign({}, tags, fieldTags);[0m            [0m[33m103[0m [0m    const combined = assign({}, tags, fieldTags);[0m
[36mdiff --git a/src/sentry/static/sentry/app/views/settings/incidentRules/metricField.tsx b/src/sentry/static/sentry/app/views/settings/incidentRules/metricField.tsx
[0m[36mindex 3acb977f8a..9ff83b3f82 100644
[0m[33m--- a/src/sentry/static/sentry/app/views/settings/incidentRules/metricField.tsx
[0m[33m+++ b/src/sentry/static/sentry/app/views/settings/incidentRules/metricField.tsx
[0m[1;34m@@ -16,7 +16,7 @@ import {
[0m[33m16[0m [0m  explodeFieldString,[0m                                         [0m[33m16[0m [0m  explodeFieldString,[0m
[33m17[0m [0m  generateFieldAsString,[0m                                      [0m[33m17[0m [0m  generateFieldAsString,[0m
[33m18[0m [0m  AggregationKey,[0m                                             [0m[33m18[0m [0m  AggregationKey,[0m
[33m19[0m [22m  FieldKey,[0m                                                   [0m[33m19[0m [22m  [7m[32mLoose[0m[22mFieldKey,[0m
[33m20[0m [0m  AGGREGATIONS,[0m                                               [0m[33m20[0m [0m  AGGREGATIONS,[0m
[33m21[0m [0m  FIELDS,[0m                                                     [0m[33m21[0m [0m  FIELDS,[0m
[33m22[0m [0m} from 'app/utils/discover/fields';[0m                           [0m[33m22[0m [0m} from 'app/utils/discover/fields';[0m
[1;34m@@ -30,7 +30,7 @@ type Props = Omit<FormField['props'], 'children' | 'help'> & {
[0m[33m30[0m [0m[0m                                                              [0m[33m30[0m [0m[0m
[33m31[0m [0mtype OptionConfig = {[0m                                         [0m[33m31[0m [0mtype OptionConfig = {[0m
[33m32[0m [0m  aggregations: AggregationKey[];[0m                             [0m[33m32[0m [0m  aggregations: AggregationKey[];[0m
[33m33[0m [22m  fields: FieldKey[];[0m                                         [0m[33m33[0m [22m  fields: [7m[32mLoose[0m[22mFieldKey[];[0m
[33m34[0m [0m};[0m                                                            [0m[33m34[0m [0m};[0m
[33m35[0m [0m[0m                                                              [0m[33m35[0m [0m[0m
[33m36[0m [0mconst errorFieldConfig: OptionConfig = {[0m                      [0m[33m36[0m [0mconst errorFieldConfig: OptionConfig = {[0m
